# 2018年产的8位CGA显卡，直播测试

Originally posted at October 18, 2018:
http://bbs.mydigit.cn/read.php?tid=2560948

准确说标题应该是“自己动手制作一张CGA显卡”
由于近段时间把所有业余时间都用在了8088项目上，所以最近进展比较快。发一张刚做的CGA显卡给大家欣赏下。
这次做的是一张CGA卡（字符卡），可以是字符卡也可以是图形卡。
CGA分辨率本来应该是640x200的。但是手上的液晶屏只有320x240的，所以...只能是将就看看了。
先上张图吧。STC12C5A60S2单片机+古董4KB RAM+tft液晶屏（51单片机驱动TFT刷新率低得吓死人，好在图片上看不出来）
![img0](images\20181018_00.jpg)

就是酱紫的一张卡。确实是2018年产的哦。显存映射地址B8000-BBFFF。

还是简单说下方案吧
## 简易CGA显卡原理
CGA占用内存空间是16KB，从B8000开始，B8000是要显示的第一个数据，B8001是这个数据的属性（闪烁，颜色等），B8002是要显示的第二个数据，以此类推。最多可以显示80x25个字符。一屏需要2000字节的地址来存储需要显示的字符，再用2000字节来存储这些字符的属性。总共就是~4KB。16KB可以存储4个页面。

此卡有两个方案，我都实验过。

**方案一**：PC机直接存取Video RAM，MCU读取RAM数据并显示。这个方案原理相对简单，不过电路复杂。
![img1](images\20181018_01.jpg)

**方案二**：PC机与MCU通信。这样。。。省略1W字。
![img2](images\20181018_02.jpg)

一分钟画完的框图，各位看官别介意。

so，就是这两个方案了，此卡用的是方案一。

## 制作过程：
很久以前做的ISA接口+万用板+双排针连接（讲究）。
![img3](images\20181018_03.jpg)

再来个背面的（强迫症的看到这里就可以啦不要往下看了，后面可能引起不适）
![img4](images\20181018_04.jpg)

先把芯片位置安排好，准备上飞线（难道我要跟你讲什么焊锡表面张力么）
![img5](images\20181018_05.jpg)

焊完了就这样了（由于这也不是什么技术贴，就省略更详细的过程啦）
![img0](images\20181018_00.jpg)

装上液晶屏就完事？
![img6](images\20181018_06.jpg)

显然是还有一张图的啦，这才是重点。销魂的飞线
![img7](images\20181018_07.jpg)

接下来简单测试下：
先把它插到一张IBM XT的兼容主板上，我喜欢这张主板，功耗很低，元件也少，这张应该是全兼容IBM 5160的吧。
![img8](images\20181018_08.jpg)

太黑了。。。
![img9](images\20181018_09.jpg)

再来张清楚点的。这款主板用的是Phoneix的BIOS。显示有点乱，主要是液晶分辨率不够提前换行了。用的8x8的字体，已经是最小的字体了。
![img10](images\20181018_10.jpg)

再插到我自己做的XT PC兼容主板上看看效果。
![img11](images\20181018_11.jpg)

![img12](images\20181018_12.jpg)

只能说能显示就不错了
![img13](images\20181018_13.jpg)

之前还做过一张更简易的CGA卡。
![img14](images\20181018_14.jpg)

![img15](images\20181018_15.jpg)

不过这张卡功耗有点大，还是放在仓库里比较合适。

其实一张完整的显卡不仅需要显存，还需要很多寄存器给cpu提供信息，还需要Video BIOS。才能发挥出更好的效果。可惜我时间不够，此贴也是抛砖引玉，因为我现在正在做一台完整的IBM兼容机（笔记本）。目前已经完成了主板，BIOS，键盘（还差一些优化），显卡（此贴显卡将会是原型）。貌似还有不少工作需要做。